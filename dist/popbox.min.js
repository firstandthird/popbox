/*!
 * popbox - Tooltip/Popover Library
 * v0.12.0
 * https://github.com/firstandthird/popbox
 * copyright First + Third 2017
 * MIT License
*/
!function(a,b){var c=0,d=function(a){this.obj=a};d.prototype.__init=function(a){b.extend(this,this.obj),this.id=c++,this.namespace=".fidel"+this.id,this.obj.defaults=this.obj.defaults||{},b.extend(this,this.obj.defaults,a),b("body").trigger("FidelPreInit",this),this.setElement(this.el||b("<div/>")),this.init&&this.init(),b("body").trigger("FidelPostInit",this)},d.prototype.eventSplitter=/^(\w+)\s*(.*)$/,d.prototype.setElement=function(a){this.el=a,this.getElements(),this.dataElements(),this.delegateEvents(),this.delegateActions()},d.prototype.find=function(a){return this.el.find(a)},d.prototype.proxy=function(a){return b.proxy(a,this)},d.prototype.getElements=function(){if(this.elements)for(var a in this.elements){var b=this.elements[a];this[b]=this.find(a)}},d.prototype.dataElements=function(){var a=this;this.find("[data-element]").each(function(c,d){var e=b(d),f=e.data("element");a[f]=e})},d.prototype.delegateEvents=function(){if(this.events)for(var a in this.events){var b=this.events[a],c=a.match(this.eventSplitter),d=c[1],e=c[2],f=this.proxy(this[b]);""===e?this.el.on(d+this.namespace,f):this[e]&&"function"!=typeof this[e]?this[e].on(d+this.namespace,f):this.el.on(d+this.namespace,e,f)}},d.prototype.delegateActions=function(){var a=this;a.el.on("click"+this.namespace,"[data-action]",function(c){var d=b(this),e=d.attr("data-action");a[e]&&a[e](c,d)})},d.prototype.on=function(a,b){this.el.on(a+this.namespace,b)},d.prototype.one=function(a,b){this.el.one(a+this.namespace,b)},d.prototype.emit=function(a,b,c){var d=c?this.namespace:"";this.el.trigger(a+d,b)},d.prototype.hide=function(){if(this.views)for(var a in this.views)this.views[a].hide();this.el.hide()},d.prototype.show=function(){if(this.views)for(var a in this.views)this.views[a].show();this.el.show()},d.prototype.destroy=function(){this.el.empty(),this.emit("destroy"),this.el.unbind(this.namespace)},d.declare=function(a){var b=function(a,b){this.__init(a,b)};return b.prototype=new d(a),b},d.onPreInit=function(a){b("body").on("FidelPreInit",function(b,c){a.call(c)})},d.onPostInit=function(a){b("body").on("FidelPostInit",function(b,c){a.call(c)})},a.Fidel=d}(window,window.jQuery||window.Zepto),function(a){a.declare=function(b,c){a.fn[b]=function(){var d,e,f=Array.prototype.slice.call(arguments),g=f.shift();return e=this.each(function(){var e=a(this),h=e.data(b);if(!h){var i=Fidel.declare(c),j=a.extend({},g,{el:e});h=new i(j),e.data(b,h)}"string"==typeof g&&(d=h[g].apply(h,f))}),"undefined"!=typeof d?d:e},a.fn[b].defaults=c.defaults||{}},a.Fidel=window.Fidel}(jQuery),function(a){a.declare("popbox",{defaults:{containerClass:"popbox",direction:"smart",directionClasses:"left left-edge up right right-edge down left-up right-up",directionOffset:10,animOffset:5,hideTimeout:100,enableHover:!0,clickToShow:!0,isTouch:"ontouchstart"in window},init:function(){this.open=!1,this.hoveringOverTooltip=!1,this.hideTimer=null,this.text=this.el.data("popbox-text")||"",this.title=this.el.data("popbox-title")||"",this.templateEl=this.el.data("popbox-el")||"",this.direction=this.el.data("popbox-direction")||this.direction,this.disableOnTouch=this.el.data("disable-touch"),this.template="",this.transitionEvents="webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",this.attachEvents()},isOpen:function(){return this.open},attachEvents:function(){this.enableHover&&!this.isTouch?(this.el.bind("mouseenter.popbox",this.proxy(this.show)),this.el.bind("mouseleave.popbox",this.proxy(this.hide))):this.isTouch&&!this.disableOnTouch&&this.el.bind("click.popbox",this.proxy(this.toggle))},reset:function(){this.template&&(this.template.unbind(".popbox"),this.template.remove())},show:function(b){this.hoveringOverTooltip||this.text&&("undefined"!=typeof b&&this.forcedOpen||("undefined"==typeof b&&(this.forcedOpen=!0),this.open||(a("body").append(this.generateTemplate()),this.template.bind("mouseenter.popbox",this.proxy(this.hoverTooltip)),this.template.bind("mouseleave.popbox",this.proxy(this.hoverLeaveTooltip)),this.template.bind("click.popbox",this.proxy(this.popboxClick)),this.position(),this.template.addClass("open")),clearTimeout(this.hideTimer),this.template.unbind(this.transitionEvents),this.open=!0,this.el.trigger("show")))},hide:function(a){this.hoveringOverTooltip||this.open&&("undefined"!=typeof a&&this.forcedOpen||("undefined"==typeof a&&(this.forcedOpen=!1),this.hideTimer=setTimeout(this.proxy(function(){this.template.removeClass("open"),this.template.bind(this.transitionEvents,this.proxy(function(){this.template.unbind(this.transitionEvents),this.reset(),this.el.trigger("hide"),this.hoveringOverTooltip=!1})),this.open=!1}),this.hideTimeout)))},toggle:function(a){if(this.clickToShow)return this.open?this.hide(a):this.show(a),!1},position:function(){this.template.css({position:"absolute"}),this.template.removeClass(this.directionClasses);var b,c,d=this.el.offset(),e="auto",f=this.direction,g=!1,h=0,i=["down","up","left","right","left-up","right-up","down"];for("smart"===this.direction&&(f=i[0]);!g;){switch(h++,f){case"left":b=d.left-this.template.outerWidth()-this.directionOffset-this.animOffset,c=d.top+this.el.outerHeight()/2-this.template.outerHeight()/2,this.template.addClass("left");break;case"up":b=d.left+this.el.outerWidth()/2-this.template.outerWidth()/2,c=d.top-this.template.outerHeight()-this.directionOffset-this.animOffset,this.template.addClass("up");break;case"right":b=d.left+this.el.outerWidth()+this.directionOffset+this.animOffset,c=d.top+this.el.outerHeight()/2-this.template.outerHeight()/2,this.template.addClass("right");break;case"down":b=d.left+this.el.outerWidth()/2-this.template.outerWidth()/2,c=d.top+this.el.outerHeight()+this.directionOffset+this.animOffset,this.template.addClass("down");break;case"left-up":b=d.left-this.template.outerWidth()/2,c=d.top-this.template.outerHeight()-this.directionOffset-this.animOffset,this.template.addClass("left-up");break;case"right-up":b=d.left+this.el.outerWidth()-this.template.outerWidth()/2,c=d.top-this.template.outerHeight()-this.directionOffset-this.animOffset,this.template.addClass("right-up")}"smart"===this.direction?(this.template.css({left:b,right:e,top:c}),this.isInViewport(this.template)||h===i.length?g=!0:(f=i[h],this.template.removeClass(this.directionClasses))):g=!0}a(window).width()-(b+this.template.outerWidth())<0?(this.template.addClass("right-edge"),b="auto",e=0):b<0&&(this.template.addClass("left-edge"),b=0),this.template.css({left:b,right:e,top:c})},generateTemplate:function(){if(this.template)return this.template;var b=a(document.createElement("div")),c=a(document.createElement("div")),d=a(document.createElement("div"));return b.addClass(this.containerClass),this.templateEl?b.append(a(this.templateEl).html()):(this.title&&(c.addClass("title"),c.html(this.title),b.append(c)),this.text&&(d.addClass("text"),d.html(this.text),b.append(d))),this.template=b,this.template},hoverTooltip:function(){clearTimeout(this.hideTimer),this.hoveringOverTooltip=!0},hoverLeaveTooltip:function(){this.hoveringOverTooltip=!1,this.el.trigger("mouseleave.popbox")},setText:function(a){this.text=a,this.open&&this.template.find(".text").text(a)},popboxClick:function(a){this.emit("popboxClick")},destroy:function(){this.reset(),this.el.unbind(".popbox"),Fidel.prototype.destroy.call(this)},isInViewport:function(b){var c=b[0].getBoundingClientRect();return c.top>=0&&c.left>=0&&c.bottom<=a(window).height()&&c.right<=a(window).width()}}),a.popboxDisableAutoAPI||a("[data-popbox]").popbox()}(jQuery);